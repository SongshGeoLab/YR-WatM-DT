# 黄河流域水资源管理决策剧场 - 用户手册

## 📖 项目简介

这是一个展示黄河流域水资源管理未来情景的交互式数据可视化平台。通过调整不同的参数组合，您可以探索从2020年到2100年的多种水资源管理情景，为决策提供科学依据。

![网站演示](https://songshgeo-picgo-1302043007.cos.ap-beijing.myqcloud.com/uPic/CleanShot%202025-10-11%20at%2010.10.46@2x.png)

### 核心特性

- **7个主题页面**: 从研究区域到水质的全方位分析
- **多参数情景**: 超过4700种参数组合情景
- **时间序列预测**: 2020-2100年的长期趋势分析
- **交互式可视化**: 实时调整参数，即时查看结果
- **深色模式**: 护眼的深色主题支持

---

## 🚀 快速开始

### 访问应用

1. **启动后端服务**（技术人员操作）
   ```bash
   make api
   # 服务运行在 http://127.0.0.1:8000
   ```

2. **启动前端应用**（技术人员操作）
   ```bash
   cd viz
   npm install
   npm run dev
   # 应用运行在 http://localhost:3000
   ```

3. **打开浏览器**
   - 在浏览器中访问显示的地址（通常是 `http://localhost:3000`）
   - 推荐使用Chrome、Firefox或Edge浏览器

---

## 🎨 界面导航

### 主界面布局

```
┌─────────────────────────────────────────────────────────┐
│  🏞️ Yellow River Basin Water Resource Analysis        │
│  Interactive Data Visualization & Scenario Analysis    │
│                                       [2020-2100]       │
├──────────┬──────────────────────────────────────────────┤
│          │                                              │
│  导航栏   │              主要内容区域                      │
│          │                                              │
│  ☐ 页面1  │        • 图表                                │
│  ☐ 页面2  │        • 参数控制                             │
│  ☐ 页面3  │        • 统计信息                             │
│  ...     │        • 说明文字                             │
│          │                                              │
│  [🌙]    │                                              │
│  [📄]    │                                              │
│  [💻]    │                                              │
└──────────┴──────────────────────────────────────────────┘
```

### 顶部栏

- **标题**: 显示应用名称"Yellow River Basin Water Resource Analysis"
- **时间范围标签**: 显示当前分析的时间跨度"2020-2100 Projection"

### 左侧导航栏

包含7个主题页面的导航按钮：
1. 🗺️ **Study Area** - 研究区域
2. 🌧️ **Water Availability** - 水资源可用性
3. 👥 **Demographics** - 人口统计
4. 🌲 **Ecological Water** - 生态用水
5. 🌾 **Agriculture** - 农业用水
6. 📊 **Water Stress** - 水资源压力
7. 🔬 **Water Quality** - 水质

### 底部工具栏

- **🌙/☀️ 主题切换**: 在深色和浅色模式之间切换
- **📄 研究论文**: 链接到相关学术论文
- **💻 代码仓库**: 访问项目源代码

---

## 📄 页面详细说明

### 1. Study Area (研究区域)

**功能**: 展示黄河流域的地理位置、流域范围和关键特征。

**内容**:
- 研究区域地图
- 流域基本信息
- 水文站点分布
- 行政区划

**使用提示**: 这个页面主要用于了解研究背景，无需参数调整。

---

### 2. Water Availability (水资源可用性)

**功能**: 展示不同气候变化情景下的水资源可用量预测。

**可调整参数**:
- **气候变化情景** (Climate change scenario switch for water yield)
  - 情景1: RCP2.6-SSP1（低排放）
  - 情景2: RCP4.5-SSP2（中等排放）
  - 情景3: RCP8.5-SSP5（高排放）

**主要变量**:
- YRB available surface water（黄河流域地表水可用量）
- hydrologic station discharge[lijin]（利津水文站径流量）

**如何使用**:
1. 点击不同的气候情景按钮
2. 观察水资源可用量的变化趋势
3. 比较不同情景下的差异

**解读提示**:
- 较高的排放情景（RCP8.5）通常会导致更大的水资源波动
- 关注峰值和谷值出现的年份

---

### 3. Demographics (人口统计)

**功能**: 展示人口变化趋势及其对水资源需求的影响。

**可调整参数**:
- **生育率** (Fertility Variation): 1.6 ~ 1.8
  - 通过滑块调整
  - 影响未来人口增长速度
- **饮食模式** (Diet change scenario switch)
  - 情景1: 传统饮食
  - 情景2: 过渡饮食
  - 情景3: 健康饮食

**主要变量**:
- Total population（总人口）
- domestic water demand province sum（生活用水需求）
- GDP per capita（人均GDP）

**如何使用**:
1. 拖动生育率滑块查看人口预测变化
2. 选择不同的饮食模式
3. 观察对生活用水需求的影响

**解读提示**:
- 生育率越高，未来人口越多，用水需求也越大
- 饮食模式会影响农业用水需求

---

### 4. Ecological Water (生态用水) ⭐

**功能**: 分析生态水流量占比对流域生态环境的影响。

> 💡 **提示**: 这是一个完全集成的交互式页面，展示了参数调整的完整功能。

**可调整参数**:
- **生态用水流量比例** (Ecological water flow variable)
  - 范围: 0.2 ~ 0.3
  - 建议值: 0.25
  - 通过滑块或快捷按钮调整

**主要变量**:
- YRB available surface water（地表水可用量）
- hydrologic station discharge[lijin]（利津径流量）
- sediment load[lijin]（利津泥沙量）

**如何使用**:
1. **调整参数**:
   - 方式1: 拖动滑块连续调整
   - 方式2: 点击快捷按钮（0.2 / 0.25 / 0.3）
2. **切换变量**: 点击上方的变量按钮查看不同指标
3. **查看统计**: 图表下方显示均值、最大值、最小值及对应年份
4. **分析趋势**: 观察不同生态流量下的长期变化

**解读提示**:
- 生态流量越高，生态环境保护越好，但可用水量会减少
- 关注泥沙负荷的变化，这与河道健康密切相关
- 注意峰值出现的年份，可能对应极端气候事件

**统计信息说明**:
- **Mean (2020-2100)**: 时间段内的平均值
- **Max Value**: 最大值及出现年份
- **Min Value**: 最小值及出现年份
- **Scenario**: 当前参数组合对应的情景编号

---

### 5. Agriculture (农业用水)

**功能**: 展示农业用水需求和节水灌溉技术的影响。

**可调整参数**:
- **节水灌溉效率** (water saving irrigation efficiency ratio)
  - 范围: 0.8 ~ 1.0
  - 数值越高表示节水效果越好
- **火力发电占比目标** (fire generation share province target)
  - 范围: 0.1 ~ 0.4
  - 影响工业用水需求

**主要变量**:
- irrigation water demand province sum（灌溉用水需求）
- production water demand province sum（生产用水需求）

**如何使用**:
1. 调整节水灌溉效率滑块
2. 设置火力发电占比
3. 观察农业和工业用水的变化

**解读提示**:
- 提高灌溉效率可以显著降低农业用水需求
- 降低火电占比有助于减少工业用水消耗

---

### 6. Water Stress (水资源压力)

**功能**: 评估水资源压力指数和供需平衡状况。

**主要变量**:
- YRB WSI（黄河流域水资源压力指数）
- water consumption of province in YRB sum（省级水资源消耗总量）

**压力等级**:
- WSI < 0.2: 低压力
- 0.2 ≤ WSI < 0.4: 中等压力
- 0.4 ≤ WSI < 0.6: 高压力
- WSI ≥ 0.6: 极高压力

**如何使用**:
1. 综合前面页面设置的所有参数
2. 查看水资源压力指数的变化
3. 识别高风险时期

**解读提示**:
- 注意WSI超过0.4的时间段，需要特别关注
- 结合其他页面的参数调整，寻找降低水压力的方案

---

### 7. Water Quality (水质)

**功能**: 展示水质指标和污染物变化趋势。

**主要变量**:
- 水质综合指标
- 污染物浓度变化

**如何使用**:
1. 查看不同情景下的水质预测
2. 关注污染物峰值时期
3. 分析水质改善措施的效果

**解读提示**:
- 水质受多种因素影响，包括工业排放、农业面源污染等
- 关注长期趋势而非短期波动

---

## 🎛️ 参数系统详解

### 参数类型

我们的系统包含6个可调整参数，共同定义了4725个情景组合：

| 参数名称 | 英文名称 | 取值范围 | 影响页面 |
|---------|---------|---------|---------|
| 生育率变化 | Fertility Variation | 1.6, 1.65, 1.7, 1.75, 1.8 | Demographics |
| 节水灌溉效率 | water saving irrigation efficiency ratio | 0.8, 0.85, 0.9, 0.95, 1.0 | Agriculture |
| 火电占比目标 | fire generation share province target | 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4 | Agriculture |
| 生态流量变量 | Ecological water flow variable | 0.2, 0.25, 0.3 | Ecological Water |
| 气候变化情景 | Climate change scenario switch | 1, 2, 3 | Water Availability |
| 饮食变化情景 | Diet change scenario switch | 1, 2, 3 | Demographics |

### 情景查询机制

**情景编号**: 系统自动生成 `sc_0` 到 `sc_4724` 共4725个情景

**查询逻辑**:
1. **完全确定**: 当所有6个参数都设置后，系统会匹配到唯一一个情景
2. **部分确定**: 当只设置部分参数时，系统会返回所有符合条件的情景
3. **置信区间**: 多情景数据可以显示为时间序列 + 置信区间

**示例**:
```
设置：气候情景=1，生育率=1.6，其他参数未设置
结果：返回多个匹配情景，图表显示均值和上下界
```

### 参数联动

页面之间的参数选择具有联动性：

```
Page 2 (气候情景) → 缩小可能情景范围
    ↓
Page 3 (人口+饮食) → 进一步缩小范围
    ↓
Page 4 (生态流量) → 继续缩小范围
    ↓
Page 5 (农业参数) → 确定唯一情景
    ↓
Page 6, 7 → 使用确定的情景显示结果
```

**最佳实践**:
1. 从Page 2开始依次设置参数
2. 观察每次参数调整后的变化
3. 在Page 6查看综合的水压力指数
4. 根据结果调整参数，寻找最优方案

---

## 📊 变量说明

### 变量名称对照

系统使用两套变量名称系统：

**原始名称** (显示用) → **安全名称** (查询用)

```
hydrologic station discharge[lijin]           → hydrologic_station_discharge_lijin
YRB available surface water                   → yrb_available_surface_water
sediment load[lijin]                          → sediment_load_lijin
irrigation water demand province sum          → irrigation_water_demand_province_sum
production water demand province sum          → production_water_demand_province_sum
OA water demand province sum                  → oa_water_demand_province_sum
domestic water demand province sum            → domestic_water_demand_province_sum
GDP per capita                                → gdp_per_capita
Total population                              → total_population
YRB WSI                                       → yrb_wsi
water consumption of province in YRB sum      → water_consumption_of_province_in_yrb_sum
```

### 完整变量列表

1. **GDP per capita** - 人均GDP
2. **OA water demand province sum** - 其他行业用水需求总和
3. **Total population** - 总人口
4. **YRB WSI** - 黄河流域水资源压力指数
5. **YRB available surface water** - 黄河流域可用地表水
6. **domestic water demand province sum** - 生活用水需求总和
7. **hydrologic station discharge[lijin]** - 利津水文站径流量
8. **irrigation water demand province sum** - 灌溉用水需求总和
9. **production water demand province sum** - 生产用水需求总和
10. **sediment load[lijin]** - 利津站泥沙负荷
11. **water consumption of province in YRB sum** - 省级水资源消耗总和

---

## 💡 使用技巧

### 情景探索建议

**初学者**:
1. 先浏览Page 1了解研究区域
2. 在Page 4 (Ecological Water) 体验参数调整功能
3. 观察滑块移动时图表的实时变化
4. 查看统计信息面板了解数据特征

**中级用户**:
1. 依次访问Page 2-5，逐步设置参数
2. 在Page 6查看综合的水压力指数
3. 尝试调整参数，寻找WSI较低的情景组合
4. 记录最优参数组合

**高级用户**:
1. 设计对比实验：固定大部分参数，只改变一个
2. 分析单个参数的影响程度
3. 探索极端情景（如高排放+高人口+低节水）
4. 导出数据进行进一步分析

### 图表阅读技巧

**趋势分析**:
- 上升趋势：问题可能恶化
- 下降趋势：情况可能改善
- 波动：受周期性因素影响

**关键点识别**:
- 峰值年份：可能的危机时期
- 谷值年份：相对安全时期
- 拐点：趋势变化的关键节点

**对比分析**:
- 调整参数前后的变化幅度
- 不同变量之间的相关性
- 多情景下的置信区间宽度

### 主题模式选择

**浅色模式** (默认):
- 适合白天使用
- 打印友好
- 图表对比度高

**深色模式**:
- 减少眼睛疲劳
- 适合长时间使用
- 节省设备电量

切换方式：点击左下角的 🌙/☀️ 按钮

---

## ❓ 常见问题

### Q1: 为什么调整参数后图表不变化？

**可能原因**:
1. 后端服务未启动
2. 参数值未在有效范围内
3. 浏览器缓存问题

**解决方法**:
1. 检查后端是否运行（访问 http://127.0.0.1:8000/docs）
2. 确认参数值在列表范围内
3. 硬刷新浏览器 (Ctrl+Shift+R 或 Cmd+Shift+R)

### Q2: 如何知道当前是哪个情景？

**答案**: 在图表下方的统计信息面板中，**Scenario** 字段显示当前情景编号，如 `sc_1234`。

### Q3: 可以同时比较多个情景吗？

**答案**: 当某些参数未设置时，系统会自动返回所有匹配的情景，图表会显示均值线和置信区间（未来功能）。

### Q4: 数据的时间范围是什么？

**答案**:
- 完整数据: 1981-2885年 (共1905个时间步)
- 展示重点: 2020-2100年 (未来预测)

### Q5: WSI（水压力指数）如何计算？

**答案**: WSI = 用水量 / 可用水量。数值越高表示水资源压力越大：
- < 0.2: 低压力
- 0.2-0.4: 中等压力
- 0.4-0.6: 高压力
- \> 0.6: 极高压力

### Q6: 能否导出数据或图表？

**答案**:
- **图表**: 鼠标悬停在图表上，点击右上角的相机图标可导出PNG
- **数据**: 目前可以通过API接口获取原始数据（需要技术支持）

### Q7: 不同气候情景有什么区别？

**答案**:
- **情景1 (RCP2.6-SSP1)**: 严格控制温室气体排放，可持续发展路径
- **情景2 (RCP4.5-SSP2)**: 中等排放，中等发展路径
- **情景3 (RCP8.5-SSP5)**: 高排放，化石燃料依赖发展

### Q8: 为什么有些变量名字带[lijin]？

**答案**: [lijin]表示利津水文站，这是黄河入海口的重要监测站点，其数据代表整个流域的出口状况。

---

## 🔧 技术支持

### 浏览器要求

- **推荐**: Chrome 90+, Firefox 88+, Edge 90+
- **最低**: 支持ES2020的现代浏览器
- **不支持**: Internet Explorer

### 性能优化

**如果遇到卡顿**:
1. 关闭其他浏览器标签页
2. 清除浏览器缓存
3. 减少时间范围
4. 使用Chrome浏览器

### 错误报告

如果遇到问题，请记录：
1. 具体操作步骤
2. 错误提示信息
3. 浏览器控制台信息（F12查看）
4. 截图

联系方式: songshgeo@gmail.com

---

## 📚 相关资源

### 学习资料

- **研究论文**: 点击左下角📄按钮查看
- **源代码**: 点击左下角💻按钮访问GitHub仓库
- **API文档**: http://127.0.0.1:8000/docs

### 引用

如果您在研究中使用了本系统，请引用：
```
[待添加引用信息]
```

---

## 🎓 教程示例

### 示例1: 探索最佳生态流量

**目标**: 找到既能保护生态又不过度影响供水的生态流量比例

**步骤**:
1. 访问 **Page 4 (Ecological Water)**
2. 设置生态流量为 **0.2**，观察水资源可用量
3. 调整为 **0.25**，比较变化
4. 调整为 **0.3**，查看影响
5. 访问 **Page 6 (Water Stress)** 查看对水压力的影响
6. 根据WSI值选择合适的生态流量比例

**预期结果**: 0.25通常是一个平衡点

### 示例2: 评估节水灌溉效果

**目标**: 量化节水灌溉技术对农业用水的影响

**步骤**:
1. 访问 **Page 5 (Agriculture)**
2. 设置节水效率为 **0.8** (基准)
3. 记录灌溉用水需求的均值
4. 调整为 **0.95**，比较差异
5. 计算节水效果 = (0.8的需求 - 0.95的需求) / 0.8的需求

**预期结果**: 约15-20%的节水潜力

### 示例3: 综合情景设计

**目标**: 设计一个可持续的水资源管理方案

**步骤**:
1. **Page 2**: 选择 **气候情景2** (中等排放)
2. **Page 3**: 设置 **生育率1.7** + **饮食情景2**
3. **Page 4**: 设置 **生态流量0.25**
4. **Page 5**: 设置 **节水效率0.9** + **火电占比0.2**
5. **Page 6**: 查看WSI，确保大部分年份 < 0.4
6. 如果WSI过高，返回调整参数

**成功标准**: WSI在2020-2100年间大部分时间 < 0.4

---

## 📞 联系我们

**项目维护**: SongshGeo
**邮箱**: songshgeo@gmail.com
**GitHub**: [项目仓库链接]

**反馈渠道**:
- 报告Bug: 提交GitHub Issue
- 功能建议: 发送邮件
- 使用疑问: 查看常见问题或联系维护者

---

## 📝 更新日志

### v1.0.0 (当前版本)
- ✅ 7个主题页面
- ✅ 4725个情景组合
- ✅ Page 4完整交互功能
- ✅ 深色模式支持
- ✅ 实时数据更新

### 未来计划
- 🔄 多情景对比功能
- 📊 更多图表类型
- 💾 数据导出功能
- 🌐 多语言支持

---

**祝您使用愉快！** 🎉

如有任何问题，请随时联系我们。
